#!/usr/bin/env bash
#jobs=`qstat -u $USER | grep -v ' C ' | grep -v ' E ' | cut -d ' ' -f 1 | grep .cclc01`
jobs=$(qstat -n -1 -u $USER | grep $USER | grep -v ' C ' | grep -v ' E ')
## jobs=$(echo "$jobs" | sed 's/.cclc01.som.ucsf//g')

njobs=$(echo "$jobs" | wc -l)
rjobs=$(echo "$jobs" | grep ' R ' | wc -l)
qjobs=$(echo "$jobs" | grep ' Q ' | wc -l)
echo "Username: $USER"
echo "Number of jobs: $njobs ($rjobs running, $qjobs queued)"

if test "$#" == "0"; then
  if test "$njobs" != "0"; then
    echo "$jobs"
  fi
else
  tjobs=$(echo "$jobs" | cut -d '.' -f 1)
  echo "qstat $* $jobs"
  qstat $* $tjobs
fi

if test "$njobs" != "0"; then
  echo "Number of jobs: $njobs ($rjobs running, $qjobs queued)"
fi




